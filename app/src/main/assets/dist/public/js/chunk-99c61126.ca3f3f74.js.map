{"version":3,"sources":["webpack:///./src/views/ChatView.vue?6450","webpack:///src/views/ChatView.vue","webpack:///./src/views/ChatView.vue?de8a","webpack:///./src/views/ChatView.vue","webpack:///./src/views/ChatView.vue?9931","webpack:///./src/assets/pic/me.png"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","targetUser","targetName","_e","style","scopedSlots","_u","key","fn","on","$event","onNegoreq","_v","proxy","_l","item","index","user","source","imgsrc2","_s","message","imgsrc1","directives","name","rawName","value","expression","domProps","target","composing","msgValue","onsendMessage","getMessage","information","Onconfirm","Oncancel","model","callback","$$v","show","staticRenderFns","data","messageList","accreq_json","uid","$store","state","avatar","components","Header","mounted","console","log","window","pullmessage_success","chatItem_receieve","accreq","methods","push","msgObj","$APP","pullmessage","targetuid","str","msg_item","negoreq","acceptaccreq","json_str","component","module","exports"],"mappings":"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","file":"public/js/chunk-99c61126.ca3f3f74.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat\"},[(_vm.targetUser)?_c('Header',{attrs:{\"is-left\":true,\"title\":_vm.targetUser.targetName}}):_vm._e(),_c('van-cell',{staticClass:\"switch\",style:({'height':'50px','margin-top':'10px'}),attrs:{\"center\":\"\",\"title\":\"保密通讯密钥交换申请\"},scopedSlots:_vm._u([{key:\"right-icon\",fn:function(){return [_c('van-button',{attrs:{\"color\":\"linear-gradient(to right, #4bb0ff, #6149f6)\"},on:{\"click\":function($event){return _vm.onNegoreq()}}},[_vm._v(\"更换密钥\")])]},proxy:true}])}),_c('div',{staticClass:\"container\"},_vm._l((_vm.messageList),function(item,index){return (_vm.targetUser && _vm.user)?_c('div',{key:index,staticClass:\"content_wrap\"},[(item.source == 'other')?_c('div',{staticClass:\"left_msg\"},[_c('img',{attrs:{\"src\":_vm.imgsrc2,\"alt\":\"\"}}),_c('span',[_vm._v(_vm._s(item.message))])]):_vm._e(),(item.source=='self')?_c('div',{staticClass:\"right_msg\"},[_c('span',[_vm._v(_vm._s(item.message))]),_c('img',{attrs:{\"src\":_vm.imgsrc1,\"alt\":\"\"}})]):_vm._e()]):_vm._e()}),0),_c('div',{staticClass:\"footer_wrap\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.msgValue),expression:\"msgValue\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.msgValue)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.msgValue=$event.target.value}}}),_c('button',{attrs:{\"disabled\":_vm.msgValue == ''},on:{\"click\":_vm.onsendMessage}},[_vm._v(\"发送\")]),_c('button',{on:{\"click\":_vm.getMessage}},[_vm._v(\"拉取\")])]),_c('van-dialog',{attrs:{\"title\":\"收到授权申请\",\"show-cancel-button\":\"\",\"confirmButtonText\":\"同意\",\"confirmButtonColor\":\"green\",\"cancelButtonColor\":\"red\",\"cancelButtonText\":\"拒绝\",\"message\":_vm.information},on:{\"confirm\":_vm.Onconfirm,\"cancel\":_vm.Oncancel},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"chat\">\r\n    <Header v-if=\"targetUser\" :is-left=\"true\" :title=\"targetUser.targetName\" />\r\n    <van-cell\r\n      :style=\"{'height':'50px','margin-top':'10px'}\"\r\n      class=\"switch\"\r\n      center\r\n      title=\"保密通讯密钥交换申请\"\r\n    >\r\n      <template #right-icon>\r\n        <van-button @click=\"onNegoreq()\" color=\"linear-gradient(to right, #4bb0ff, #6149f6)\">更换密钥</van-button>\r\n      </template>\r\n    </van-cell>\r\n\r\n    <div class=\"container\">\r\n      <!-- 聊天内容 -->\r\n      <div\r\n        class=\"content_wrap\"\r\n        v-if=\"targetUser && user\"\r\n        v-for=\"(item,index) in messageList\"\r\n        :key=\"index\"\r\n      >\r\n        <!-- 别人的内容 -->\r\n        <div class=\"left_msg\" v-if=\"item.source == 'other'\">\r\n          <img :src=\"imgsrc2\" alt />\r\n          <span>{{item.message}}</span>\r\n        </div>\r\n        <!-- 我的内容 -->\r\n        <div class=\"right_msg\" v-if=\"item.source=='self'\">\r\n          <span>{{item.message}}</span>\r\n          <img :src=\"imgsrc1\" alt />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"footer_wrap\">\r\n      <input type=\"text\" v-model=\"msgValue\" />\r\n      <button :disabled=\"msgValue == ''\" @click=\"onsendMessage\">发送</button>\r\n      <button @click=\"getMessage\">拉取</button>\r\n    </div>\r\n    <van-dialog v-model=\"show\" title=\"收到授权申请\"\r\n     show-cancel-button confirmButtonText=\"同意\"\r\n     confirmButtonColor=\"green\"\r\n     cancelButtonColor=\"red\"\r\n     cancelButtonText=\"拒绝\"\r\n     :message=\"information\"\r\n     @confirm=\"Onconfirm\" @cancel=\"Oncancel\">\r\n\r\n     </van-dialog>\r\n  </div>\r\n</template>\r\n\r\n// <script>\r\nimport Header from \"../components/privilegeManager/Header\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      msgValue: \"\",\r\n      show:false,\r\n      messageList: [\r\n      //   {message:'你好 张三',\r\n      //   source:'self'\r\n      // },\r\n      // {\r\n      //   message:'你好',\r\n      //   source:'other'\r\n      // },\r\n      // {message:'今天5点我在办公楼等你',\r\n      //   source:'self'\r\n      // },\r\n      ],\r\n      accreq_json:{\r\n  //  \"accsee\": 5,\r\n  //  \"hubuuid\": \"ACCDCBAEFFAAV\",\r\n  //  \"info\": \"北京市通州区西集镇北苑街道2号楼\",\r\n  //  \"infolen\": 18,\r\n  //  \"pub\": [-9, -39, 20, 22, 33, 19, 116, -11, 93, 101, 81, -124, 44, 98, -78, 1, 82, 59, -37, 57, -18, 108, 93, -41, -93, -25, -109, 23, -99, 48, -32, -27, -34, -120, -41, -34, -58, 12, -82, 113, 57, -82, 68, 92, -84, -128, -107, 86, 0, -62, -82, 80, 47, -101, 63, -50, -58, 62, 40, 55, 100, 82, 64, -58],\r\n  //  \"signdata\": [-66, -110, -75, 33, 37, -92, -104, 54, 101, -50, 109, -19, -117, 103, 6, 83, -77, 93, -83, 85, -59, -65, -53, 60, 72, 21, 106, -47, -33, -40, 29, 114, -32, 79, 47, 4, 69, 24, 108, -21, 74, 16, -89, -121, 116, -106, -103, 58, 108, -114, 111, -112, -63, -70, 1, 16, 17, -89, -3, 26, -54, 38, -83, -17],\r\n  //  \"signdatalen\": 64,\r\n  //  \"time\":\"2020-03-26 :05:16:47\"\r\n  },\r\n      imgsrc1:require('../assets/pic/me.png'),\r\n      imgsrc2:require('../assets/pic/friends.png'),\r\n      information:'',\r\n      user: {\r\n        uid: this.$store.state.uid,\r\n        avatar: \"\"\r\n      },\r\n      targetUser: this.$store.state.target,\r\n    }\r\n  },\r\n  components: {\r\n    Header\r\n  },\r\n\r\n  mounted() {\r\n    //一上来先拉取消息\r\n\r\n    //  this.getMessage()\r\n    console.log(this.targetUser);\r\n    console.log(this.user.uid);\r\n    window.pullmessage_success = this.pullmessage_success; //挂载拉取成功后的方法\r\n    window.chatItem_receieve = this.chatItem_receieve;\r\n    window.accreq=this.accreq\r\n  },\r\n  methods: {\r\n    onsendMessage() {\r\n      //发送消息\r\n      // $APP.sendMessage(this.msgValue, 100, this.targetUser.targetuid);\r\n      // 需要发送的消息对象\r\n      const msgObj = {\r\n        // host_id:this.user.uid,\r\n        // guest_id: this.targetUser.targetuid,\r\n        message: this.msgValue,\r\n        // msg_type:100,\r\n        source: \"self\" //这块的source为了区分消息是我发的还是对方发的，后面会去掉这个属性，直接以message的host_id和guest_id判断\r\n      };\r\n      // 本地客户端显示\r\n      this.messageList.push(msgObj);\r\n      // 清空input\r\n      this.msgValue = \"\";\r\n    },\r\n    getMessage() {\r\n      $APP.pullmessage(this.targetUser.targetuid, this.user.uid);\r\n    },\r\n    pullmessage_success() {\r\n      console.log(\"拉取成功\");\r\n    },\r\n    chatItem_receieve(str) {\r\n      const msg_item = {\r\n        message: str,\r\n        source: \"other\"\r\n      };\r\n      this.messageList.push(msg_item);\r\n    },\r\n    onNegoreq() {\r\n      $APP.negoreq(this.targetUser.targetuid);\r\n    },\r\n    Onconfirm(){\r\n      console.log(\"调用了确认事件\")\r\n      $APP.acceptaccreq(this.json_str,this.$store.state.target.targetuid)\r\n    },\r\n    Oncancel(){\r\n      console.log(\"调用了拒绝事件\")\r\n       $APP.denide(this.json_str,this.$store.state.target.targetuid)\r\n\r\n    },\r\n    accreq(str){\r\n      this.accreq_json=JSON.parse(str)\r\n      this.information=JSON.stringify('accsee: '+this.accreq_json.accsee)+'\\n'+JSON.stringify('hubuuid: '+this.accreq_json.hubuuid)+'\\n'+JSON.stringify('info: '+this.accreq_json.info)+'\\n'+JSON.stringify('time: '+this.accreq_json.time)\r\n      this.show=true\r\n//         console.log(str)\r\n//         this.accreq_json=JSON.parse(str)\r\n//         this.$dialog.confirm({\r\n//          confirmButtonText:\"同意\",\r\n//          showCancelButton:true,\r\n//          confirmButtonColor:'green',\r\n//          cancelButtonColor:'red',\r\n//          cancelButtonText:\"拒绝\",\r\n//          title: \"接到授权申请\", //加上标题\r\n//          message:JSON.stringify('accsee: '+this.accreq_json.accsee)+'\\n'+JSON.stringify('hubuuid: '+this.accreq_json.hubuuid)+'\\n'+JSON.stringify('info: '+this.accreq_json.info)+'\\n'+JSON.stringify('time: '+this.accreq_json.info)//改变弹出框的内容\r\n// })\r\n//     .then(() => { //点击确认按钮后的调用\r\n//          console.log(\"调用接受事件\")\r\n//\r\n\r\n// })\r\n//     .catch(() => { //点击取消按钮后的调用\r\n//            console.log(\"调用拒绝事件\")\r\n//\r\n\r\n// })\r\n}\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.chat {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n.head {\r\n  height: 90px;\r\n}\r\n.container {\r\n  width: 100%;\r\n  height: calc(100% - 140px);\r\n  box-sizing: border-box;\r\n  background-color: #f1f1f1;\r\n  margin-top: 105px;\r\n  padding: 8px;\r\n  overflow-y: scroll;\r\n}\r\n.switch {\r\n  position: absolute;\r\n  width: 100%;\r\n  top: 40px;\r\n}\r\n.footer_wrap {\r\n  width: 100%;\r\n  height: 50px;\r\n  box-sizing: border-box;\r\n  border-top: 1px solid #d9d9d9;\r\n  position: absolute;\r\n  bottom: 0;\r\n  padding: 8px;\r\n  background-color: #fafafa;\r\n}\r\n.footer_wrap input {\r\n  width: 50%;\r\n  height: 30px;\r\n  outline: none;\r\n  border: 1px solid #d9d9d9;\r\n  border-radius: 4px;\r\n  font-size: 15px;\r\n}\r\n.footer_wrap button {\r\n  width: 20%;\r\n  height: 34px;\r\n  border: 1px solid #d9d9d9;\r\n  border-radius: 4px;\r\n  margin-left: 8px;\r\n  outline: none;\r\n  background-color: #f1f1f1;\r\n  font-size: 15px;\r\n}\r\n.footer_wrap button[disabled] {\r\n  background-color: #d9d9d9;\r\n  cursor: not-allowed;\r\n  pointer-events: none;\r\n}\r\n\r\n.left_msg {\r\n  justify-content: flex-start;\r\n}\r\n.right_msg {\r\n  justify-content: flex-end;\r\n}\r\n.left_msg,\r\n.right_msg {\r\n  width: 100%;\r\n\r\n  display: flex;\r\n  margin: 10px 0;\r\n}\r\n.content_wrap img {\r\n  width: 1rem;\r\n  height: 1rem;\r\n}\r\n.content_wrap span {\r\n  display: inline-block;\r\n  max-width: 65%;\r\n  border: 1px solid #d9d9d9;\r\n  border-radius: 4px;\r\n  margin: 0 5px;\r\n  padding: 8px;\r\n  box-sizing: border-box;\r\n  word-break: break-all;\r\n}\r\n.left_msg span {\r\n  background-color: #fff;\r\n  font-size: 15px;\r\n}\r\n.right_msg span {\r\n  background-color: #0fce0d;\r\n  font-size: 15px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./ChatView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./ChatView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChatView.vue?vue&type=template&id=f3a3d732&scoped=true&\"\nimport script from \"./ChatView.vue?vue&type=script&lang=js&\"\nexport * from \"./ChatView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChatView.vue?vue&type=style&index=0&id=f3a3d732&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f3a3d732\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./ChatView.vue?vue&type=style&index=0&id=f3a3d732&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.3@vue-loader/lib/index.js??vue-loader-options!./ChatView.vue?vue&type=style&index=0&id=f3a3d732&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"public/img/me.044b0a53.png\";"],"sourceRoot":""}